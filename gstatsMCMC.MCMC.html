<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Python: module gstatsMCMC.MCMC</title>
</head><body>

<table class="heading">
<tr class="heading-text decor">
<td class="title">&nbsp;<br><strong class="title"><a href="gstatsMCMC.html" class="white">gstatsMCMC</a>.MCMC</strong></td>
<td class="extra"><a href=".">index</a><br><a href="file:/home/niyashao/3MC/geostatsMCMC/gstatsMCMC/MCMC.py">/home/niyashao/3MC/geostatsMCMC/gstatsMCMC/MCMC.py</a></td></tr></table>
    <p><span class="code">Created&nbsp;on&nbsp;Thu&nbsp;Jun&nbsp;26&nbsp;16:57:24&nbsp;2025<br>
&nbsp;<br>
@author:&nbsp;niyashao</span></p>
<p>
<table class="section">
<tr class="decor pkg-content-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Modules</strong></td></tr>
    
<tr><td class="decor pkg-content-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><table><tr><td class="multicolumn"><a href="gstatsMCMC.Topography.html">gstatsMCMC.Topography</a><br>
<a href="gstatsim.html">gstatsim</a><br>
<a href="gstools.html">gstools</a><br>
</td><td class="multicolumn"><a href="skgstat.models.html">skgstat.models</a><br>
<a href="numpy.html">numpy</a><br>
<a href="pandas.html">pandas</a><br>
</td><td class="multicolumn"><a href="matplotlib.pyplot.html">matplotlib.pyplot</a><br>
<a href="pydoc.html">pydoc</a><br>
<a href="skgstat.html">skgstat</a><br>
</td><td class="multicolumn"></td></tr></table></td></tr></table><p>
<table class="section">
<tr class="decor index-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Classes</strong></td></tr>
    
<tr><td class="decor index-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl>
<dt class="heading-text"><a href="builtins.html#object">builtins.object</a>
</dt><dd>
<dl>
<dt class="heading-text"><a href="gstatsMCMC.MCMC.html#RandField">RandField</a>
</dt><dt class="heading-text"><a href="gstatsMCMC.MCMC.html#chain">chain</a>
</dt><dd>
<dl>
<dt class="heading-text"><a href="gstatsMCMC.MCMC.html#chain_crf">chain_crf</a>
</dt><dt class="heading-text"><a href="gstatsMCMC.MCMC.html#chain_sgs">chain_sgs</a>
</dt></dl>
</dd>
</dl>
</dd>
</dl>
 <p>
<table class="section">
<tr class="decor title-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><a name="RandField">class <strong>RandField</strong></a>(<a href="builtins.html#object">builtins.object</a>)</td></tr>
    
<tr><td class="decor title-decor" rowspan=2><span class="code">&nbsp;&nbsp;&nbsp;</span></td>
<td class="decor title-decor" colspan=2><span class="code"><a href="#RandField">RandField</a>(range_max_x,&nbsp;range_max_y,&nbsp;range_min_x,&nbsp;range_min_y,&nbsp;scale_min,&nbsp;scale_max,&nbsp;nugget_max,&nbsp;model_name,&nbsp;isotropic,&nbsp;smoothness=None,&nbsp;rng='default')<br>
&nbsp;<br>
a&nbsp;class&nbsp;used&nbsp;to&nbsp;represent&nbsp;unconditional&nbsp;or&nbsp;conditional&nbsp;random&nbsp;field<br>&nbsp;</span></td></tr>
<tr><td>&nbsp;</td>
<td class="singlecolumn">Methods defined here:<br>
<dl><dt><a name="RandField-__init__"><strong>__init__</strong></a>(self, range_max_x, range_max_y, range_min_x, range_min_y, scale_min, scale_max, nugget_max, model_name, isotropic, smoothness=None, rng='default')</dt><dd><span class="code">Initialize&nbsp;a&nbsp;<a href="#RandField">RandField</a>&nbsp;<a href="builtins.html#object">object</a>&nbsp;for&nbsp;generating&nbsp;conditional&nbsp;or&nbsp;unconditional&nbsp;random&nbsp;field.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;range_max_x&nbsp;(float):&nbsp;Maximum&nbsp;spatial&nbsp;correlation&nbsp;range&nbsp;in&nbsp;x-direction.&nbsp;The&nbsp;random&nbsp;field&nbsp;will&nbsp;randomly&nbsp;sampled&nbsp;between&nbsp;range_max_x&nbsp;and&nbsp;range_min_x&nbsp;to&nbsp;determine&nbsp;its&nbsp;range&nbsp;in&nbsp;the&nbsp;x&nbsp;direction,&nbsp;and&nbsp;similarly&nbsp;for&nbsp;range&nbsp;in&nbsp;y&nbsp;direction.<br>
&nbsp;&nbsp;&nbsp;&nbsp;range_max_y&nbsp;(float):&nbsp;Maximum&nbsp;range&nbsp;in&nbsp;y-direction.<br>
&nbsp;&nbsp;&nbsp;&nbsp;range_min_x&nbsp;(float):&nbsp;Minimum&nbsp;range&nbsp;in&nbsp;x-direction.<br>
&nbsp;&nbsp;&nbsp;&nbsp;range_min_y&nbsp;(float):&nbsp;Minimum&nbsp;range&nbsp;in&nbsp;y-direction.<br>
&nbsp;&nbsp;&nbsp;&nbsp;scale_min&nbsp;(float):&nbsp;Minimum&nbsp;vertical&nbsp;scaling&nbsp;(std&nbsp;dev)&nbsp;of&nbsp;field.<br>
&nbsp;&nbsp;&nbsp;&nbsp;scale_max&nbsp;(float):&nbsp;Maximum&nbsp;vertical&nbsp;scaling&nbsp;of&nbsp;field.<br>
&nbsp;&nbsp;&nbsp;&nbsp;nugget_max&nbsp;(float):&nbsp;Maximum&nbsp;nugget&nbsp;effect&nbsp;in&nbsp;the&nbsp;variogram.<br>
&nbsp;&nbsp;&nbsp;&nbsp;model_name&nbsp;(str):&nbsp;Variogram&nbsp;model&nbsp;type&nbsp;('Gaussian',&nbsp;'Exponential',&nbsp;'Matern').<br>
&nbsp;&nbsp;&nbsp;&nbsp;isotropic&nbsp;(bool):&nbsp;Whether&nbsp;to&nbsp;enforce&nbsp;isotropic&nbsp;spatial&nbsp;correlation.&nbsp;If&nbsp;isotropic&nbsp;is&nbsp;set&nbsp;to&nbsp;False,&nbsp;then&nbsp;fields&nbsp;with&nbsp;random&nbsp;anistropy&nbsp;direction&nbsp;will&nbsp;be&nbsp;generated,&nbsp;where&nbsp;the&nbsp;strength&nbsp;of&nbsp;anistropy&nbsp;is&nbsp;dependent&nbsp;on&nbsp;the&nbsp;ratio&nbsp;between&nbsp;range&nbsp;in&nbsp;x-direction&nbsp;and&nbsp;in&nbsp;y-direction.<br>
&nbsp;&nbsp;&nbsp;&nbsp;smoothness&nbsp;(float):&nbsp;Variogram&nbsp;smoothness&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;rng&nbsp;(str&nbsp;or&nbsp;Generator):&nbsp;(optional)&nbsp;Random&nbsp;number&nbsp;generator&nbsp;or&nbsp;string&nbsp;'default'.</span></dd></dl>

<dl><dt><a name="RandField-get_block_sizes"><strong>get_block_sizes</strong></a>(self)</dt></dl>

<dl><dt><a name="RandField-get_crf_weight"><strong>get_crf_weight</strong></a>(self, xx, yy, cond_data_mask)</dt><dd><span class="code">Generate&nbsp;conditional&nbsp;random&nbsp;field&nbsp;weights&nbsp;from&nbsp;conditioning&nbsp;data&nbsp;mask.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;(2D&nbsp;array):&nbsp;x-coordinate&nbsp;grid.<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;(2D&nbsp;array):&nbsp;y-coordinate&nbsp;grid.<br>
&nbsp;&nbsp;&nbsp;&nbsp;cond_data_mask&nbsp;(2D&nbsp;array):&nbsp;Binary&nbsp;mask&nbsp;of&nbsp;conditioning&nbsp;data&nbsp;(1&nbsp;=&nbsp;present).<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;weight&nbsp;(2D&nbsp;array):&nbsp;weight&nbsp;used&nbsp;to&nbsp;condition&nbsp;the&nbsp;field&nbsp;to&nbsp;conditioning&nbsp;data<br>
&nbsp;&nbsp;&nbsp;&nbsp;dist&nbsp;(2D&nbsp;array):&nbsp;Distance&nbsp;to&nbsp;conditioning&nbsp;points.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dist_rescale&nbsp;(2D&nbsp;array):&nbsp;Scaled&nbsp;distances,&nbsp;where&nbsp;0&nbsp;correspond&nbsp;to&nbsp;0,&nbsp;and&nbsp;1&nbsp;correspond&nbsp;to&nbsp;self.<strong>max_dist</strong>.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dist_logi&nbsp;(2D&nbsp;array):&nbsp;The&nbsp;raw&nbsp;logistic&nbsp;function&nbsp;values</span></dd></dl>

<dl><dt><a name="RandField-get_crf_weight_from_dist"><strong>get_crf_weight_from_dist</strong></a>(self, xx, yy, dist)</dt><dd><span class="code">Generate&nbsp;conditional&nbsp;random&nbsp;field&nbsp;weights&nbsp;from&nbsp;calculated&nbsp;distance.&nbsp;<br>
Used&nbsp;in&nbsp;large&nbsp;domain&nbsp;where&nbsp;calculating&nbsp;distance&nbsp;takes&nbsp;too&nbsp;long&nbsp;and&nbsp;thus&nbsp;the&nbsp;distance&nbsp;could&nbsp;be&nbsp;previously&nbsp;saved&nbsp;in&nbsp;files<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;(2D&nbsp;array):&nbsp;x-coordinate&nbsp;grid.<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;(2D&nbsp;array):&nbsp;y-coordinate&nbsp;grid.<br>
&nbsp;&nbsp;&nbsp;&nbsp;cond_data_mask&nbsp;(2D&nbsp;array):&nbsp;Binary&nbsp;mask&nbsp;of&nbsp;conditioning&nbsp;data&nbsp;(1&nbsp;=&nbsp;present).<br>
&nbsp;&nbsp;&nbsp;&nbsp;dist&nbsp;(2D&nbsp;array):&nbsp;Distance&nbsp;to&nbsp;conditioning&nbsp;points.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;weight&nbsp;(2D&nbsp;array):&nbsp;weight&nbsp;used&nbsp;to&nbsp;condition&nbsp;the&nbsp;field&nbsp;to&nbsp;conditioning&nbsp;data<br>
&nbsp;&nbsp;&nbsp;&nbsp;dist_rescale&nbsp;(2D&nbsp;array):&nbsp;Scaled&nbsp;distances,&nbsp;where&nbsp;0&nbsp;correspond&nbsp;to&nbsp;0,&nbsp;and&nbsp;1&nbsp;correspond&nbsp;to&nbsp;self.<strong>max_dist</strong>.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dist_logi&nbsp;(2D&nbsp;array):&nbsp;The&nbsp;raw&nbsp;logistic&nbsp;function&nbsp;values</span></dd></dl>

<dl><dt><a name="RandField-get_edge_masks"><strong>get_edge_masks</strong></a>(self)</dt></dl>

<dl><dt><a name="RandField-get_random_field"><strong>get_random_field</strong></a>(self, X, Y, _mean=0, _var=1, n=1)</dt><dd><span class="code">Generate&nbsp;a&nbsp;random&nbsp;field&nbsp;using&nbsp;specified&nbsp;model&nbsp;parameter&nbsp;when&nbsp;initiating&nbsp;the&nbsp;<a href="#RandField">RandField</a>&nbsp;<a href="builtins.html#object">object</a>.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;(1D&nbsp;numpy&nbsp;array):&nbsp;x-coordinates&nbsp;of&nbsp;the&nbsp;grid.<br>
&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;(1D&nbsp;numpy&nbsp;array):&nbsp;y-coordinates&nbsp;of&nbsp;the&nbsp;grid.<br>
&nbsp;&nbsp;&nbsp;&nbsp;_mean&nbsp;(float):&nbsp;Mean&nbsp;of&nbsp;the&nbsp;field.&nbsp;Default&nbsp;is&nbsp;0.&nbsp;Do&nbsp;not&nbsp;change&nbsp;it<br>
&nbsp;&nbsp;&nbsp;&nbsp;_var&nbsp;(float):&nbsp;Variance&nbsp;of&nbsp;the&nbsp;field.&nbsp;Default&nbsp;is&nbsp;1.&nbsp;Do&nbsp;not&nbsp;change&nbsp;it<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;field&nbsp;(2D&nbsp;numpy&nbsp;array):&nbsp;Realization&nbsp;of&nbsp;the&nbsp;random&nbsp;field.</span></dd></dl>

<dl><dt><a name="RandField-get_rfblock"><strong>get_rfblock</strong></a>(self)</dt><dd><span class="code">Generate&nbsp;a&nbsp;random&nbsp;field&nbsp;block&nbsp;based&nbsp;on&nbsp;the&nbsp;information&nbsp;stored&nbsp;in&nbsp;the&nbsp;<a href="#RandField">RandField</a>&nbsp;<a href="builtins.html#object">object</a>.<br>
The&nbsp;block&nbsp;size&nbsp;is&nbsp;randomly&nbsp;selected&nbsp;from&nbsp;values&nbsp;defined&nbsp;in&nbsp;<a href="#RandField-set_block_sizes">set_block_sizes</a>()&nbsp;function.&nbsp;<br>
The&nbsp;random&nbsp;field&nbsp;has&nbsp;a&nbsp;logistic&nbsp;decay&nbsp;to&nbsp;the&nbsp;block's&nbsp;edges<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;(2D&nbsp;numpy&nbsp;array):&nbsp;a&nbsp;random&nbsp;field&nbsp;sample&nbsp;shaped&nbsp;by&nbsp;logistic&nbsp;mask.</span></dd></dl>

<dl><dt><a name="RandField-logistic"><strong>logistic</strong></a>(x, L, x0, k)</dt></dl>

<dl><dt><a name="RandField-min_dist"><strong>min_dist</strong></a>(hard_mat, xx, yy)</dt></dl>

<dl><dt><a name="RandField-rescale"><strong>rescale</strong></a>(x, maxdist)</dt></dl>

<dl><dt><a name="RandField-set_block_param"><strong>set_block_param</strong></a>(self, logis_func_L, logis_func_x0, logis_func_k, logis_func_offset, max_dist, resolution)</dt><dd><span class="code">Set&nbsp;logistic&nbsp;function&nbsp;parameters&nbsp;for&nbsp;generating&nbsp;conditioning&nbsp;weight&nbsp;used&nbsp;on&nbsp;both&nbsp;conditioning&nbsp;to&nbsp;the&nbsp;data&nbsp;and&nbsp;conditioning&nbsp;to&nbsp;the&nbsp;edge&nbsp;of&nbsp;the&nbsp;block<br>
The&nbsp;logistic&nbsp;function&nbsp;has&nbsp;a&nbsp;format&nbsp;of&nbsp;f(x)&nbsp;=&nbsp;(L&nbsp;/&nbsp;(1&nbsp;+&nbsp;exp(-k(x&nbsp;-&nbsp;x0))))&nbsp;-&nbsp;offset,&nbsp;where&nbsp;the&nbsp;x&nbsp;here&nbsp;represent&nbsp;the&nbsp;distance&nbsp;to&nbsp;the&nbsp;nearest&nbsp;conditioning&nbsp;data<br>
In&nbsp;the&nbsp;generated&nbsp;conditioning&nbsp;weight,&nbsp;the&nbsp;weight&nbsp;is&nbsp;highest&nbsp;(1)&nbsp;at&nbsp;the&nbsp;conditioning&nbsp;data,&nbsp;and&nbsp;has&nbsp;a&nbsp;logistic&nbsp;decay&nbsp;based&nbsp;on&nbsp;distance&nbsp;to&nbsp;the&nbsp;nearest&nbsp;conditioning&nbsp;data<br>
&nbsp;<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;logis_func_L&nbsp;(float):&nbsp;L&nbsp;parameter&nbsp;of&nbsp;logistic&nbsp;function.<br>
&nbsp;&nbsp;&nbsp;&nbsp;logis_func_x0&nbsp;(float):&nbsp;Midpoint&nbsp;x0&nbsp;of&nbsp;logistic&nbsp;function.<br>
&nbsp;&nbsp;&nbsp;&nbsp;logis_func_k&nbsp;(float):&nbsp;Growth&nbsp;rate&nbsp;k&nbsp;of&nbsp;logistic&nbsp;function.<br>
&nbsp;&nbsp;&nbsp;&nbsp;logis_func_offset&nbsp;(float):&nbsp;Constant&nbsp;subtracted&nbsp;from&nbsp;logistic&nbsp;output.<br>
&nbsp;&nbsp;&nbsp;&nbsp;max_dist&nbsp;(float):&nbsp;Max&nbsp;distance&nbsp;for&nbsp;mask&nbsp;scaling.<br>
&nbsp;&nbsp;&nbsp;&nbsp;resolution&nbsp;(float):&nbsp;Grid&nbsp;cell&nbsp;resolution.</span></dd></dl>

<dl><dt><a name="RandField-set_block_sizes"><strong>set_block_sizes</strong></a>(self, min_block_x, max_block_x, min_block_y, max_block_y, steps=5)</dt><dd><span class="code">Set&nbsp;the&nbsp;allowable&nbsp;range&nbsp;of&nbsp;block&nbsp;sizes&nbsp;used&nbsp;for&nbsp;random&nbsp;field&nbsp;generation.<br>
The&nbsp;function&nbsp;has&nbsp;no&nbsp;returned&nbsp;value.&nbsp;But&nbsp;the&nbsp;effect&nbsp;can&nbsp;be&nbsp;evaluated&nbsp;by&nbsp;the&nbsp;'pair'&nbsp;attribute&nbsp;of&nbsp;the&nbsp;<a href="#RandField">RandField</a>&nbsp;<a href="builtins.html#object">object</a><br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;min_block_x&nbsp;(int):&nbsp;Minimum&nbsp;block&nbsp;width.<br>
&nbsp;&nbsp;&nbsp;&nbsp;max_block_x&nbsp;(int):&nbsp;Maximum&nbsp;block&nbsp;width.<br>
&nbsp;&nbsp;&nbsp;&nbsp;min_block_y&nbsp;(int):&nbsp;Minimum&nbsp;block&nbsp;height.<br>
&nbsp;&nbsp;&nbsp;&nbsp;max_block_y&nbsp;(int):&nbsp;Maximum&nbsp;block&nbsp;height.<br>
&nbsp;&nbsp;&nbsp;&nbsp;steps&nbsp;(int):&nbsp;Number&nbsp;of&nbsp;steps&nbsp;between&nbsp;min&nbsp;and&nbsp;max,&nbsp;determining&nbsp;number&nbsp;of&nbsp;different&nbsp;sizes&nbsp;between&nbsp;min_x&nbsp;and&nbsp;max_x&nbsp;or&nbsp;between&nbsp;min_y&nbsp;and&nbsp;max_y&nbsp;Default&nbsp;is&nbsp;5.</span></dd></dl>

<hr>
Data descriptors defined here:<br>
<dl><dt><strong>__dict__</strong></dt>
<dd><span class="code">dictionary&nbsp;for&nbsp;instance&nbsp;variables</span></dd>
</dl>
<dl><dt><strong>__weakref__</strong></dt>
<dd><span class="code">list&nbsp;of&nbsp;weak&nbsp;references&nbsp;to&nbsp;the&nbsp;object</span></dd>
</dl>
</td></tr></table> <p>
<table class="section">
<tr class="decor title-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><a name="chain">class <strong>chain</strong></a>(<a href="builtins.html#object">builtins.object</a>)</td></tr>
    
<tr><td class="decor title-decor" rowspan=2><span class="code">&nbsp;&nbsp;&nbsp;</span></td>
<td class="decor title-decor" colspan=2><span class="code"><a href="#chain">chain</a>(xx,&nbsp;yy,&nbsp;bed,&nbsp;surf,&nbsp;velx,&nbsp;vely,&nbsp;dhdt,&nbsp;smb,&nbsp;cond_bed,&nbsp;data_mask,&nbsp;grounded_ice_mask,&nbsp;resolution)<br>
&nbsp;<br>
parent&nbsp;class&nbsp;for&nbsp;both&nbsp;the&nbsp;crf_chain&nbsp;and&nbsp;sgs_chain<br>&nbsp;</span></td></tr>
<tr><td>&nbsp;</td>
<td class="singlecolumn">Methods defined here:<br>
<dl><dt><a name="chain-__init__"><strong>__init__</strong></a>(self, xx, yy, bed, surf, velx, vely, dhdt, smb, cond_bed, data_mask, grounded_ice_mask, resolution)</dt><dd><span class="code">Initialize&nbsp;the&nbsp;Markov&nbsp;<a href="#chain">chain</a>&nbsp;<a href="builtins.html#object">object</a>&nbsp;for&nbsp;topography&nbsp;sampling.<br>
The&nbsp;function&nbsp;has&nbsp;no&nbsp;returns&nbsp;but&nbsp;the&nbsp;input&nbsp;argument&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;<a href="#chain">chain</a>&nbsp;<a href="builtins.html#object">object</a><br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;xx,&nbsp;yy&nbsp;(2D&nbsp;array):&nbsp;x&nbsp;and&nbsp;y&nbsp;coordinates&nbsp;of&nbsp;the&nbsp;map&nbsp;grid.<br>
&nbsp;&nbsp;&nbsp;&nbsp;bed&nbsp;(2D&nbsp;array):&nbsp;Initial&nbsp;bed&nbsp;topography.<br>
&nbsp;&nbsp;&nbsp;&nbsp;surf&nbsp;(2D&nbsp;array):&nbsp;Ice&nbsp;surface&nbsp;elevation.<br>
&nbsp;&nbsp;&nbsp;&nbsp;velx,&nbsp;vely&nbsp;(2D&nbsp;array):&nbsp;Ice&nbsp;surface&nbsp;velocity&nbsp;in&nbsp;x&nbsp;direction&nbsp;and&nbsp;in&nbsp;y&nbsp;direction.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dhdt&nbsp;(2D&nbsp;array):&nbsp;Surface&nbsp;height&nbsp;change&nbsp;rate&nbsp;(annual&nbsp;average).<br>
&nbsp;&nbsp;&nbsp;&nbsp;smb&nbsp;(2D&nbsp;array):&nbsp;Surface&nbsp;mass&nbsp;balance&nbsp;(annual&nbsp;average).<br>
&nbsp;&nbsp;&nbsp;&nbsp;cond_bed&nbsp;(2D&nbsp;array):&nbsp;Conditioning&nbsp;radar&nbsp;bed&nbsp;measurements&nbsp;in&nbsp;the&nbsp;shape&nbsp;of&nbsp;the&nbsp;2D&nbsp;domain.&nbsp;For&nbsp;locations&nbsp;without&nbsp;measurement,&nbsp;the&nbsp;value&nbsp;is&nbsp;nan<br>
&nbsp;&nbsp;&nbsp;&nbsp;data_mask&nbsp;(2D&nbsp;array):&nbsp;Mask&nbsp;of&nbsp;where&nbsp;conditioning&nbsp;data&nbsp;exists&nbsp;(1&nbsp;=&nbsp;exist).<br>
&nbsp;&nbsp;&nbsp;&nbsp;grounded_ice_mask&nbsp;(2D&nbsp;array):&nbsp;Binary&nbsp;mask&nbsp;of&nbsp;grounded&nbsp;ice&nbsp;(1&nbsp;=&nbsp;grounded).<br>
&nbsp;&nbsp;&nbsp;&nbsp;resolution&nbsp;(float):&nbsp;Spatial&nbsp;resolution&nbsp;in&nbsp;meters.<br>
&nbsp;<br>
Raises:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Exception:&nbsp;If&nbsp;input&nbsp;arrays&nbsp;do&nbsp;not&nbsp;have&nbsp;matching&nbsp;shapes.</span></dd></dl>

<dl><dt><a name="chain-__init_func__"><strong>__init_func__</strong></a>(self)</dt></dl>

<dl><dt><a name="chain-loss"><strong>loss</strong></a>(self, massConvResidual, dataDiff)</dt><dd><span class="code">Compute&nbsp;total&nbsp;loss&nbsp;from&nbsp;mass&nbsp;conservation&nbsp;residuals&nbsp;and&nbsp;data&nbsp;misfit&nbsp;by&nbsp;applying&nbsp;function&nbsp;defined&nbsp;in&nbsp;set_loss_type<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;massConvResidual&nbsp;(2D&nbsp;array):&nbsp;Mass&nbsp;conservation&nbsp;residual&nbsp;field.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dataDiff&nbsp;(2D&nbsp;array):&nbsp;Difference&nbsp;between&nbsp;candidate&nbsp;and&nbsp;observed&nbsp;bed&nbsp;elevation.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;total_loss&nbsp;(float):&nbsp;Combined&nbsp;loss&nbsp;value.<br>
&nbsp;&nbsp;&nbsp;&nbsp;loss_mc&nbsp;(float):&nbsp;Loss&nbsp;due&nbsp;to&nbsp;mass&nbsp;conservation&nbsp;residual.<br>
&nbsp;&nbsp;&nbsp;&nbsp;loss_data&nbsp;(float):&nbsp;Loss&nbsp;due&nbsp;to&nbsp;data&nbsp;misfit.</span></dd></dl>

<dl><dt><a name="chain-set_high_vel_region"><strong>set_high_vel_region</strong></a>(self, update_in_region, region_mask=[])</dt><dd><span class="code">Define&nbsp;spatial&nbsp;region&nbsp;where&nbsp;ice&nbsp;surface&nbsp;velocity&nbsp;is&nbsp;high&nbsp;to&nbsp;constrain&nbsp;the&nbsp;location&nbsp;of&nbsp;updates.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;update_in_region&nbsp;(bool):&nbsp;Whether&nbsp;to&nbsp;constrain&nbsp;updates&nbsp;to&nbsp;region_mask.<br>
&nbsp;&nbsp;&nbsp;&nbsp;region_mask&nbsp;(2D&nbsp;array):&nbsp;Binary&nbsp;mask&nbsp;specifying&nbsp;region&nbsp;of&nbsp;interest.<br>
&nbsp;<br>
Raises:<br>
&nbsp;&nbsp;&nbsp;&nbsp;ValueError:&nbsp;If&nbsp;region_mask&nbsp;has&nbsp;incorrect&nbsp;shape.</span></dd></dl>

<dl><dt><a name="chain-set_loss_type"><strong>set_loss_type</strong></a>(self, map_func=None, diff_func=None, sigma_mc=-1, sigma_data=-1, massConvInRegion=True, dataDiffInRegion=False)</dt><dd><span class="code">Configure&nbsp;loss&nbsp;function&nbsp;used&nbsp;in&nbsp;MCMC&nbsp;<a href="#chain">chain</a><br>
Currently&nbsp;enable&nbsp;two&nbsp;losses&nbsp;to&nbsp;be&nbsp;used:&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;and&nbsp;misfit&nbsp;to&nbsp;radar&nbsp;measurements.<br>
The&nbsp;function&nbsp;has&nbsp;no&nbsp;return.&nbsp;Its&nbsp;effect&nbsp;can&nbsp;be&nbsp;checked&nbsp;in&nbsp;<a href="#chain">chain</a>&nbsp;<a href="builtins.html#object">object</a>'s&nbsp;'loss_function_list'&nbsp;attribute<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;map_func&nbsp;(str):&nbsp;Function&nbsp;to&nbsp;use&nbsp;for&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;('meanabs',&nbsp;'meansquare',&nbsp;'sumabs',&nbsp;'sumsquare',&nbsp;None).&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Default&nbsp;is&nbsp;None.&nbsp;If&nbsp;set&nbsp;to&nbsp;None,&nbsp;then&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;is&nbsp;not&nbsp;used&nbsp;for&nbsp;calculating&nbsp;the&nbsp;loss.<br>
&nbsp;&nbsp;&nbsp;&nbsp;'sumsquare'&nbsp;correspond&nbsp;to&nbsp;treat&nbsp;the&nbsp;residual&nbsp;as&nbsp;Gaussian&nbsp;distribution<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;diff_func&nbsp;(str):&nbsp;Function&nbsp;to&nbsp;use&nbsp;for&nbsp;misfit&nbsp;to&nbsp;radar&nbsp;measurements&nbsp;('meanabs',&nbsp;'meansquare',&nbsp;'sumabs',&nbsp;'sumsquare',&nbsp;None).&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Default&nbsp;is&nbsp;None.&nbsp;If&nbsp;set&nbsp;to&nbsp;None,&nbsp;then&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;is&nbsp;not&nbsp;used&nbsp;for&nbsp;calculating&nbsp;the&nbsp;loss.<br>
&nbsp;&nbsp;&nbsp;&nbsp;'sumsquare'&nbsp;correspond&nbsp;to&nbsp;treat&nbsp;the&nbsp;misfit&nbsp;as&nbsp;Gaussian&nbsp;distribution<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;sigma_mc&nbsp;(float):&nbsp;Standard&nbsp;deviation&nbsp;for&nbsp;mass&nbsp;conservation&nbsp;residual.<br>
&nbsp;&nbsp;&nbsp;&nbsp;sigma_data&nbsp;(float):&nbsp;Standard&nbsp;deviation&nbsp;for&nbsp;data&nbsp;misfit.<br>
&nbsp;&nbsp;&nbsp;&nbsp;massConvInRegion&nbsp;(bool):&nbsp;Whether&nbsp;to&nbsp;calculate&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;only&nbsp;in&nbsp;region_mask.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dataDiffInRegion&nbsp;(bool):&nbsp;Whether&nbsp;to&nbsp;calculate&nbsp;data&nbsp;misfit&nbsp;loss&nbsp;only&nbsp;in&nbsp;region_mask.<br>
&nbsp;<br>
Raises:<br>
&nbsp;&nbsp;&nbsp;&nbsp;ValueError:&nbsp;If&nbsp;function&nbsp;names&nbsp;are&nbsp;invalid&nbsp;or&nbsp;sigmas&nbsp;are&nbsp;missing.</span></dd></dl>

<hr>
Data descriptors defined here:<br>
<dl><dt><strong>__dict__</strong></dt>
<dd><span class="code">dictionary&nbsp;for&nbsp;instance&nbsp;variables</span></dd>
</dl>
<dl><dt><strong>__weakref__</strong></dt>
<dd><span class="code">list&nbsp;of&nbsp;weak&nbsp;references&nbsp;to&nbsp;the&nbsp;object</span></dd>
</dl>
</td></tr></table> <p>
<table class="section">
<tr class="decor title-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><a name="chain_crf">class <strong>chain_crf</strong></a>(<a href="gstatsMCMC.MCMC.html#chain">chain</a>)</td></tr>
    
<tr><td class="decor title-decor" rowspan=2><span class="code">&nbsp;&nbsp;&nbsp;</span></td>
<td class="decor title-decor" colspan=2><span class="code"><a href="#chain_crf">chain_crf</a>(xx,&nbsp;yy,&nbsp;bed,&nbsp;surf,&nbsp;velx,&nbsp;vely,&nbsp;dhdt,&nbsp;smb,&nbsp;cond_bed,&nbsp;data_mask,&nbsp;grounded_ice_mask,&nbsp;resolution)<br>
&nbsp;<br>
Inherit&nbsp;the&nbsp;<a href="#chain">chain</a>&nbsp;class.&nbsp;Used&nbsp;for&nbsp;creating&nbsp;random&nbsp;field-based&nbsp;MCMC&nbsp;chains.&nbsp;Can&nbsp;choose&nbsp;between&nbsp;conditional&nbsp;or&nbsp;unconditional&nbsp;random&nbsp;fields<br>&nbsp;</span></td></tr>
<tr><td>&nbsp;</td>
<td class="singlecolumn"><dl><dt>Method resolution order:</dt>
<dd><a href="gstatsMCMC.MCMC.html#chain_crf">chain_crf</a></dd>
<dd><a href="gstatsMCMC.MCMC.html#chain">chain</a></dd>
<dd><a href="builtins.html#object">builtins.object</a></dd>
</dl>
<hr>
Methods defined here:<br>
<dl><dt><a name="chain_crf-__init_func__"><strong>__init_func__</strong></a>(self)</dt></dl>

<dl><dt><a name="chain_crf-run"><strong>run</strong></a>(self, n_iter, RF, rng='default')</dt><dd><span class="code">Run&nbsp;the&nbsp;MCMC&nbsp;<a href="#chain">chain</a>&nbsp;using&nbsp;block-based&nbsp;CRF/RF&nbsp;perturbations.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_iter&nbsp;(int):&nbsp;Number&nbsp;of&nbsp;iterations&nbsp;in&nbsp;the&nbsp;MCMC&nbsp;<a href="#chain">chain</a>.<br>
&nbsp;&nbsp;&nbsp;&nbsp;RF&nbsp;(<a href="#RandField">RandField</a>):&nbsp;Random&nbsp;field&nbsp;generator.<br>
&nbsp;&nbsp;&nbsp;&nbsp;rng&nbsp;(str&nbsp;or&nbsp;np.random.Generator):&nbsp;Random&nbsp;number&nbsp;generator.&nbsp;Default&nbsp;is&nbsp;'default',&nbsp;which&nbsp;makes&nbsp;a&nbsp;random&nbsp;generator&nbsp;with&nbsp;random&nbsp;seeds<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;bed_cache&nbsp;(4D&nbsp;array):&nbsp;Topography&nbsp;at&nbsp;each&nbsp;iteration.<br>
&nbsp;&nbsp;&nbsp;&nbsp;loss_mc_cache&nbsp;(1D&nbsp;array):&nbsp;Mass&nbsp;conservation&nbsp;residual&nbsp;loss&nbsp;at&nbsp;each&nbsp;iteration.&nbsp;If&nbsp;the&nbsp;mass&nbsp;conservation&nbsp;loss&nbsp;is&nbsp;not&nbsp;used,&nbsp;return&nbsp;array&nbsp;of&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;loss_data_cache&nbsp;(1D&nbsp;array):&nbsp;Data&nbsp;misfit&nbsp;loss&nbsp;at&nbsp;each&nbsp;iteration.&nbsp;If&nbsp;the&nbsp;data&nbsp;misfit&nbsp;loss&nbsp;is&nbsp;not&nbsp;used,&nbsp;return&nbsp;array&nbsp;of&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;loss_cache&nbsp;(1D&nbsp;array):&nbsp;Total&nbsp;loss&nbsp;at&nbsp;each&nbsp;iteration.<br>
&nbsp;&nbsp;&nbsp;&nbsp;step_cache&nbsp;(1D&nbsp;array):&nbsp;Boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;step&nbsp;was&nbsp;accepted.<br>
&nbsp;&nbsp;&nbsp;&nbsp;resampled_times&nbsp;(2D&nbsp;array):&nbsp;Number&nbsp;of&nbsp;times&nbsp;each&nbsp;pixel&nbsp;was&nbsp;updated.<br>
&nbsp;&nbsp;&nbsp;&nbsp;blocks_cache&nbsp;(2D&nbsp;array):&nbsp;Info&nbsp;on&nbsp;block&nbsp;proposals&nbsp;at&nbsp;each&nbsp;iteration.</span></dd></dl>

<dl><dt><a name="chain_crf-set_crf_data_weight"><strong>set_crf_data_weight</strong></a>(self, RF)</dt><dd><span class="code">Calculate&nbsp;and&nbsp;store&nbsp;CRF&nbsp;weights&nbsp;from&nbsp;conditioning&nbsp;data&nbsp;using&nbsp;<a href="#RandField">RandField</a>&nbsp;<a href="builtins.html#object">object</a>.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;RF&nbsp;(<a href="#RandField">RandField</a>):&nbsp;A&nbsp;<a href="#RandField">RandField</a>&nbsp;<a href="builtins.html#object">object</a>&nbsp;configured&nbsp;for&nbsp;CRF&nbsp;weight&nbsp;generation.</span></dd></dl>

<dl><dt><a name="chain_crf-set_update_type"><strong>set_update_type</strong></a>(self, block_type)</dt><dd><span class="code">Set&nbsp;types&nbsp;of&nbsp;the&nbsp;perturbation&nbsp;blocks.&nbsp;<br>
For&nbsp;now,&nbsp;can&nbsp;choose&nbsp;from&nbsp;unconditional&nbsp;random&nbsp;field&nbsp;('RF')&nbsp;or&nbsp;conditional&nbsp;random&nbsp;field&nbsp;created&nbsp;by&nbsp;logistic&nbsp;weighting&nbsp;(CRF_weight)<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;block_type&nbsp;(str):&nbsp;'CRF_weight',&nbsp;'CRF_rbf'&nbsp;(not&nbsp;implemented),&nbsp;or&nbsp;'RF'.<br>
&nbsp;<br>
Raises:<br>
&nbsp;&nbsp;&nbsp;&nbsp;ValueError:&nbsp;If&nbsp;block_type&nbsp;is&nbsp;invalid.</span></dd></dl>

<hr>
Methods inherited from <a href="gstatsMCMC.MCMC.html#chain">chain</a>:<br>
<dl><dt><a name="chain_crf-__init__"><strong>__init__</strong></a>(self, xx, yy, bed, surf, velx, vely, dhdt, smb, cond_bed, data_mask, grounded_ice_mask, resolution)</dt><dd><span class="code">Initialize&nbsp;the&nbsp;Markov&nbsp;<a href="#chain">chain</a>&nbsp;<a href="builtins.html#object">object</a>&nbsp;for&nbsp;topography&nbsp;sampling.<br>
The&nbsp;function&nbsp;has&nbsp;no&nbsp;returns&nbsp;but&nbsp;the&nbsp;input&nbsp;argument&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;<a href="#chain">chain</a>&nbsp;<a href="builtins.html#object">object</a><br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;xx,&nbsp;yy&nbsp;(2D&nbsp;array):&nbsp;x&nbsp;and&nbsp;y&nbsp;coordinates&nbsp;of&nbsp;the&nbsp;map&nbsp;grid.<br>
&nbsp;&nbsp;&nbsp;&nbsp;bed&nbsp;(2D&nbsp;array):&nbsp;Initial&nbsp;bed&nbsp;topography.<br>
&nbsp;&nbsp;&nbsp;&nbsp;surf&nbsp;(2D&nbsp;array):&nbsp;Ice&nbsp;surface&nbsp;elevation.<br>
&nbsp;&nbsp;&nbsp;&nbsp;velx,&nbsp;vely&nbsp;(2D&nbsp;array):&nbsp;Ice&nbsp;surface&nbsp;velocity&nbsp;in&nbsp;x&nbsp;direction&nbsp;and&nbsp;in&nbsp;y&nbsp;direction.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dhdt&nbsp;(2D&nbsp;array):&nbsp;Surface&nbsp;height&nbsp;change&nbsp;rate&nbsp;(annual&nbsp;average).<br>
&nbsp;&nbsp;&nbsp;&nbsp;smb&nbsp;(2D&nbsp;array):&nbsp;Surface&nbsp;mass&nbsp;balance&nbsp;(annual&nbsp;average).<br>
&nbsp;&nbsp;&nbsp;&nbsp;cond_bed&nbsp;(2D&nbsp;array):&nbsp;Conditioning&nbsp;radar&nbsp;bed&nbsp;measurements&nbsp;in&nbsp;the&nbsp;shape&nbsp;of&nbsp;the&nbsp;2D&nbsp;domain.&nbsp;For&nbsp;locations&nbsp;without&nbsp;measurement,&nbsp;the&nbsp;value&nbsp;is&nbsp;nan<br>
&nbsp;&nbsp;&nbsp;&nbsp;data_mask&nbsp;(2D&nbsp;array):&nbsp;Mask&nbsp;of&nbsp;where&nbsp;conditioning&nbsp;data&nbsp;exists&nbsp;(1&nbsp;=&nbsp;exist).<br>
&nbsp;&nbsp;&nbsp;&nbsp;grounded_ice_mask&nbsp;(2D&nbsp;array):&nbsp;Binary&nbsp;mask&nbsp;of&nbsp;grounded&nbsp;ice&nbsp;(1&nbsp;=&nbsp;grounded).<br>
&nbsp;&nbsp;&nbsp;&nbsp;resolution&nbsp;(float):&nbsp;Spatial&nbsp;resolution&nbsp;in&nbsp;meters.<br>
&nbsp;<br>
Raises:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Exception:&nbsp;If&nbsp;input&nbsp;arrays&nbsp;do&nbsp;not&nbsp;have&nbsp;matching&nbsp;shapes.</span></dd></dl>

<dl><dt><a name="chain_crf-loss"><strong>loss</strong></a>(self, massConvResidual, dataDiff)</dt><dd><span class="code">Compute&nbsp;total&nbsp;loss&nbsp;from&nbsp;mass&nbsp;conservation&nbsp;residuals&nbsp;and&nbsp;data&nbsp;misfit&nbsp;by&nbsp;applying&nbsp;function&nbsp;defined&nbsp;in&nbsp;set_loss_type<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;massConvResidual&nbsp;(2D&nbsp;array):&nbsp;Mass&nbsp;conservation&nbsp;residual&nbsp;field.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dataDiff&nbsp;(2D&nbsp;array):&nbsp;Difference&nbsp;between&nbsp;candidate&nbsp;and&nbsp;observed&nbsp;bed&nbsp;elevation.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;total_loss&nbsp;(float):&nbsp;Combined&nbsp;loss&nbsp;value.<br>
&nbsp;&nbsp;&nbsp;&nbsp;loss_mc&nbsp;(float):&nbsp;Loss&nbsp;due&nbsp;to&nbsp;mass&nbsp;conservation&nbsp;residual.<br>
&nbsp;&nbsp;&nbsp;&nbsp;loss_data&nbsp;(float):&nbsp;Loss&nbsp;due&nbsp;to&nbsp;data&nbsp;misfit.</span></dd></dl>

<dl><dt><a name="chain_crf-set_high_vel_region"><strong>set_high_vel_region</strong></a>(self, update_in_region, region_mask=[])</dt><dd><span class="code">Define&nbsp;spatial&nbsp;region&nbsp;where&nbsp;ice&nbsp;surface&nbsp;velocity&nbsp;is&nbsp;high&nbsp;to&nbsp;constrain&nbsp;the&nbsp;location&nbsp;of&nbsp;updates.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;update_in_region&nbsp;(bool):&nbsp;Whether&nbsp;to&nbsp;constrain&nbsp;updates&nbsp;to&nbsp;region_mask.<br>
&nbsp;&nbsp;&nbsp;&nbsp;region_mask&nbsp;(2D&nbsp;array):&nbsp;Binary&nbsp;mask&nbsp;specifying&nbsp;region&nbsp;of&nbsp;interest.<br>
&nbsp;<br>
Raises:<br>
&nbsp;&nbsp;&nbsp;&nbsp;ValueError:&nbsp;If&nbsp;region_mask&nbsp;has&nbsp;incorrect&nbsp;shape.</span></dd></dl>

<dl><dt><a name="chain_crf-set_loss_type"><strong>set_loss_type</strong></a>(self, map_func=None, diff_func=None, sigma_mc=-1, sigma_data=-1, massConvInRegion=True, dataDiffInRegion=False)</dt><dd><span class="code">Configure&nbsp;loss&nbsp;function&nbsp;used&nbsp;in&nbsp;MCMC&nbsp;<a href="#chain">chain</a><br>
Currently&nbsp;enable&nbsp;two&nbsp;losses&nbsp;to&nbsp;be&nbsp;used:&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;and&nbsp;misfit&nbsp;to&nbsp;radar&nbsp;measurements.<br>
The&nbsp;function&nbsp;has&nbsp;no&nbsp;return.&nbsp;Its&nbsp;effect&nbsp;can&nbsp;be&nbsp;checked&nbsp;in&nbsp;<a href="#chain">chain</a>&nbsp;<a href="builtins.html#object">object</a>'s&nbsp;'loss_function_list'&nbsp;attribute<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;map_func&nbsp;(str):&nbsp;Function&nbsp;to&nbsp;use&nbsp;for&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;('meanabs',&nbsp;'meansquare',&nbsp;'sumabs',&nbsp;'sumsquare',&nbsp;None).&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Default&nbsp;is&nbsp;None.&nbsp;If&nbsp;set&nbsp;to&nbsp;None,&nbsp;then&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;is&nbsp;not&nbsp;used&nbsp;for&nbsp;calculating&nbsp;the&nbsp;loss.<br>
&nbsp;&nbsp;&nbsp;&nbsp;'sumsquare'&nbsp;correspond&nbsp;to&nbsp;treat&nbsp;the&nbsp;residual&nbsp;as&nbsp;Gaussian&nbsp;distribution<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;diff_func&nbsp;(str):&nbsp;Function&nbsp;to&nbsp;use&nbsp;for&nbsp;misfit&nbsp;to&nbsp;radar&nbsp;measurements&nbsp;('meanabs',&nbsp;'meansquare',&nbsp;'sumabs',&nbsp;'sumsquare',&nbsp;None).&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Default&nbsp;is&nbsp;None.&nbsp;If&nbsp;set&nbsp;to&nbsp;None,&nbsp;then&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;is&nbsp;not&nbsp;used&nbsp;for&nbsp;calculating&nbsp;the&nbsp;loss.<br>
&nbsp;&nbsp;&nbsp;&nbsp;'sumsquare'&nbsp;correspond&nbsp;to&nbsp;treat&nbsp;the&nbsp;misfit&nbsp;as&nbsp;Gaussian&nbsp;distribution<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;sigma_mc&nbsp;(float):&nbsp;Standard&nbsp;deviation&nbsp;for&nbsp;mass&nbsp;conservation&nbsp;residual.<br>
&nbsp;&nbsp;&nbsp;&nbsp;sigma_data&nbsp;(float):&nbsp;Standard&nbsp;deviation&nbsp;for&nbsp;data&nbsp;misfit.<br>
&nbsp;&nbsp;&nbsp;&nbsp;massConvInRegion&nbsp;(bool):&nbsp;Whether&nbsp;to&nbsp;calculate&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;only&nbsp;in&nbsp;region_mask.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dataDiffInRegion&nbsp;(bool):&nbsp;Whether&nbsp;to&nbsp;calculate&nbsp;data&nbsp;misfit&nbsp;loss&nbsp;only&nbsp;in&nbsp;region_mask.<br>
&nbsp;<br>
Raises:<br>
&nbsp;&nbsp;&nbsp;&nbsp;ValueError:&nbsp;If&nbsp;function&nbsp;names&nbsp;are&nbsp;invalid&nbsp;or&nbsp;sigmas&nbsp;are&nbsp;missing.</span></dd></dl>

<hr>
Data descriptors inherited from <a href="gstatsMCMC.MCMC.html#chain">chain</a>:<br>
<dl><dt><strong>__dict__</strong></dt>
<dd><span class="code">dictionary&nbsp;for&nbsp;instance&nbsp;variables</span></dd>
</dl>
<dl><dt><strong>__weakref__</strong></dt>
<dd><span class="code">list&nbsp;of&nbsp;weak&nbsp;references&nbsp;to&nbsp;the&nbsp;object</span></dd>
</dl>
</td></tr></table> <p>
<table class="section">
<tr class="decor title-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><a name="chain_sgs">class <strong>chain_sgs</strong></a>(<a href="gstatsMCMC.MCMC.html#chain">chain</a>)</td></tr>
    
<tr><td class="decor title-decor" rowspan=2><span class="code">&nbsp;&nbsp;&nbsp;</span></td>
<td class="decor title-decor" colspan=2><span class="code"><a href="#chain_sgs">chain_sgs</a>(xx,&nbsp;yy,&nbsp;bed,&nbsp;surf,&nbsp;velx,&nbsp;vely,&nbsp;dhdt,&nbsp;smb,&nbsp;cond_bed,&nbsp;data_mask,&nbsp;grounded_ice_mask,&nbsp;resolution)<br>
&nbsp;<br>
Inherit&nbsp;the&nbsp;<a href="#chain">chain</a>&nbsp;class.&nbsp;Used&nbsp;for&nbsp;creating&nbsp;sequential&nbsp;gaussian&nbsp;simulation&nbsp;blocks-based&nbsp;MCMC&nbsp;chains.<br>&nbsp;</span></td></tr>
<tr><td>&nbsp;</td>
<td class="singlecolumn"><dl><dt>Method resolution order:</dt>
<dd><a href="gstatsMCMC.MCMC.html#chain_sgs">chain_sgs</a></dd>
<dd><a href="gstatsMCMC.MCMC.html#chain">chain</a></dd>
<dd><a href="builtins.html#object">builtins.object</a></dd>
</dl>
<hr>
Methods defined here:<br>
<dl><dt><a name="chain_sgs-__init_func__"><strong>__init_func__</strong></a>(self)</dt></dl>

<dl><dt><a name="chain_sgs-run"><strong>run</strong></a>(self, n_iter, rng='default')</dt><dd><span class="code">Run&nbsp;the&nbsp;MCMC&nbsp;<a href="#chain">chain</a>&nbsp;using&nbsp;block-based&nbsp;SGS&nbsp;updates<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_iter&nbsp;(int):&nbsp;Number&nbsp;of&nbsp;iterations&nbsp;in&nbsp;the&nbsp;MCMC&nbsp;<a href="#chain">chain</a>.<br>
&nbsp;&nbsp;&nbsp;&nbsp;rng&nbsp;(str&nbsp;or&nbsp;np.random.Generator):&nbsp;Random&nbsp;number&nbsp;generator.&nbsp;Default&nbsp;is&nbsp;'default',&nbsp;which&nbsp;makes&nbsp;a&nbsp;random&nbsp;generator&nbsp;with&nbsp;random&nbsp;seeds<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;bed_cache&nbsp;(4D&nbsp;array):&nbsp;Topography&nbsp;at&nbsp;each&nbsp;iteration.<br>
&nbsp;&nbsp;&nbsp;&nbsp;loss_mc_cache&nbsp;(1D&nbsp;array):&nbsp;Mass&nbsp;conservation&nbsp;residual&nbsp;loss&nbsp;at&nbsp;each&nbsp;iteration.&nbsp;If&nbsp;the&nbsp;mass&nbsp;conservation&nbsp;loss&nbsp;is&nbsp;not&nbsp;used,&nbsp;return&nbsp;array&nbsp;of&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;loss_data_cache&nbsp;(1D&nbsp;array):&nbsp;Data&nbsp;misfit&nbsp;loss&nbsp;at&nbsp;each&nbsp;iteration.&nbsp;If&nbsp;the&nbsp;data&nbsp;misfit&nbsp;loss&nbsp;is&nbsp;not&nbsp;used,&nbsp;return&nbsp;array&nbsp;of&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;loss_cache&nbsp;(1D&nbsp;array):&nbsp;Total&nbsp;loss&nbsp;at&nbsp;each&nbsp;iteration.<br>
&nbsp;&nbsp;&nbsp;&nbsp;step_cache&nbsp;(1D&nbsp;array):&nbsp;Boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;step&nbsp;was&nbsp;accepted.<br>
&nbsp;&nbsp;&nbsp;&nbsp;resampled_times&nbsp;(2D&nbsp;array):&nbsp;Number&nbsp;of&nbsp;times&nbsp;each&nbsp;pixel&nbsp;was&nbsp;updated.<br>
&nbsp;&nbsp;&nbsp;&nbsp;blocks_cache&nbsp;(2D&nbsp;array):&nbsp;Info&nbsp;on&nbsp;block&nbsp;proposals&nbsp;at&nbsp;each&nbsp;iteration.</span></dd></dl>

<dl><dt><a name="chain_sgs-set_block_sizes"><strong>set_block_sizes</strong></a>(self, block_min_x, block_min_y, block_max_x, block_max_y)</dt><dd><span class="code">Set&nbsp;minimum&nbsp;and&nbsp;maximum&nbsp;block&nbsp;sizes&nbsp;(in&nbsp;grid&nbsp;cells)&nbsp;for&nbsp;SGS&nbsp;updates.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;block_min_x&nbsp;(int):&nbsp;Minimum&nbsp;width&nbsp;of&nbsp;block&nbsp;in&nbsp;x-direction.&nbsp;Unit&nbsp;in&nbsp;grid&nbsp;cells<br>
&nbsp;&nbsp;&nbsp;&nbsp;block_min_y&nbsp;(int):&nbsp;Minimum&nbsp;height&nbsp;of&nbsp;block&nbsp;in&nbsp;y-direction.<br>
&nbsp;&nbsp;&nbsp;&nbsp;block_max_x&nbsp;(int):&nbsp;Maximum&nbsp;width&nbsp;of&nbsp;block&nbsp;in&nbsp;x-direction.<br>
&nbsp;&nbsp;&nbsp;&nbsp;block_max_y&nbsp;(int):&nbsp;Maximum&nbsp;height&nbsp;of&nbsp;block&nbsp;in&nbsp;y-direction.</span></dd></dl>

<dl><dt><a name="chain_sgs-set_normal_transformation"><strong>set_normal_transformation</strong></a>(self, nst_trans)</dt><dd><span class="code">Set&nbsp;the&nbsp;normal&nbsp;score&nbsp;transformation&nbsp;<a href="builtins.html#object">object</a>&nbsp;(from&nbsp;scikit-learn&nbsp;package)&nbsp;used&nbsp;to&nbsp;normalize&nbsp;the&nbsp;bed&nbsp;elevation.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;nst_trans&nbsp;(QuantileTransformer):&nbsp;A&nbsp;fitted&nbsp;scikit-learn&nbsp;transformer&nbsp;used&nbsp;to&nbsp;normalize&nbsp;input&nbsp;data.<br>
&nbsp;<br>
Note:<br>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;transformation&nbsp;must&nbsp;be&nbsp;fit&nbsp;beforehand&nbsp;(e.g.,&nbsp;via&nbsp;`MCMC.fit_variogram`)&nbsp;and&nbsp;should&nbsp;match&nbsp;the&nbsp;scale&nbsp;of&nbsp;bed&nbsp;values.</span></dd></dl>

<dl><dt><a name="chain_sgs-set_sgs_param"><strong>set_sgs_param</strong></a>(self, sgs_num_nearest_neighbors, sgs_searching_radius, sgs_rand_dropout_on=False, dropout_rate=0)</dt><dd><span class="code">Set&nbsp;parameters&nbsp;for&nbsp;Sequential&nbsp;Gaussian&nbsp;Simulation&nbsp;(SGS).<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;sgs_num_nearest_neighbors&nbsp;(int):&nbsp;Number&nbsp;of&nbsp;nearest&nbsp;neighbors&nbsp;used&nbsp;in&nbsp;simulation.<br>
&nbsp;&nbsp;&nbsp;&nbsp;sgs_searching_radius&nbsp;(float):&nbsp;Radius&nbsp;(in&nbsp;meters)&nbsp;to&nbsp;search&nbsp;for&nbsp;neighbors.<br>
&nbsp;&nbsp;&nbsp;&nbsp;sgs_rand_dropout_on&nbsp;(bool):&nbsp;Whether&nbsp;to&nbsp;randomly&nbsp;drop&nbsp;conditioning&nbsp;points&nbsp;in&nbsp;simulation&nbsp;block.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dropout_rate&nbsp;(float):&nbsp;Proportion&nbsp;of&nbsp;conditioning&nbsp;data&nbsp;to&nbsp;drop&nbsp;if&nbsp;dropout&nbsp;is&nbsp;enabled&nbsp;(between&nbsp;0&nbsp;and&nbsp;1).</span></dd></dl>

<dl><dt><a name="chain_sgs-set_trend"><strong>set_trend</strong></a>(self, trend=None, detrend_map=True)</dt><dd><span class="code">Set&nbsp;the&nbsp;long-wavelength&nbsp;trend&nbsp;component&nbsp;of&nbsp;the&nbsp;bed&nbsp;topography.<br>
Notice&nbsp;that&nbsp;detrend&nbsp;topography&nbsp;means&nbsp;that&nbsp;the&nbsp;SGS&nbsp;simulation&nbsp;will&nbsp;only&nbsp;simulate&nbsp;the&nbsp;short-wavelength&nbsp;topography&nbsp;residuals&nbsp;that&nbsp;is&nbsp;not&nbsp;a&nbsp;part&nbsp;of&nbsp;the&nbsp;trend<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;trend&nbsp;(2D&nbsp;array):&nbsp;The&nbsp;trend&nbsp;surface&nbsp;to&nbsp;add&nbsp;back&nbsp;after&nbsp;SGS&nbsp;sampling.<br>
&nbsp;&nbsp;&nbsp;&nbsp;detrend_map&nbsp;(bool):&nbsp;If&nbsp;True,&nbsp;remove&nbsp;trend&nbsp;before&nbsp;transforming&nbsp;the&nbsp;bed&nbsp;elevation&nbsp;and&nbsp;add&nbsp;it&nbsp;back&nbsp;after&nbsp;inverse&nbsp;transform.<br>
&nbsp;<br>
Raises:<br>
&nbsp;&nbsp;&nbsp;&nbsp;ValueError:&nbsp;If&nbsp;detrend_map&nbsp;is&nbsp;True&nbsp;but&nbsp;trend&nbsp;has&nbsp;invalid&nbsp;shape.</span></dd></dl>

<dl><dt><a name="chain_sgs-set_variogram"><strong>set_variogram</strong></a>(self, vario_type, vario_range, vario_sill, vario_nugget, isotropic=True, vario_smoothness=None, vario_azimuth=None)</dt><dd><span class="code">Specify&nbsp;variogram&nbsp;model&nbsp;and&nbsp;its&nbsp;parameters&nbsp;for&nbsp;SGS&nbsp;interpolation.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;vario_type&nbsp;(str):&nbsp;Variogram&nbsp;model&nbsp;type.&nbsp;One&nbsp;of&nbsp;'Gaussian',&nbsp;'Exponential',&nbsp;'Spherical',&nbsp;'Matern'.<br>
&nbsp;&nbsp;&nbsp;&nbsp;vario_range&nbsp;(float&nbsp;or&nbsp;list):&nbsp;Correlation&nbsp;range(s).&nbsp;One&nbsp;value&nbsp;for&nbsp;isotropic;&nbsp;list&nbsp;of&nbsp;two&nbsp;for&nbsp;anisotropic.<br>
&nbsp;&nbsp;&nbsp;&nbsp;vario_sill&nbsp;(float):&nbsp;Variogram&nbsp;sill&nbsp;(variance).<br>
&nbsp;&nbsp;&nbsp;&nbsp;vario_nugget&nbsp;(float):&nbsp;Nugget&nbsp;effect.<br>
&nbsp;&nbsp;&nbsp;&nbsp;isotropic&nbsp;(bool):&nbsp;Whether&nbsp;the&nbsp;variogram&nbsp;is&nbsp;isotropic.&nbsp;Default&nbsp;is&nbsp;True.<br>
&nbsp;&nbsp;&nbsp;&nbsp;vario_smoothness&nbsp;(float):&nbsp;Smoothness&nbsp;parameter&nbsp;for&nbsp;Matern&nbsp;model&nbsp;(required&nbsp;if&nbsp;`vario_type`&nbsp;is&nbsp;'Matern').<br>
&nbsp;&nbsp;&nbsp;&nbsp;vario_azimuth&nbsp;(float):&nbsp;Azimuth&nbsp;angle&nbsp;for&nbsp;anisotropic&nbsp;variograms&nbsp;in&nbsp;degrees.&nbsp;Units&nbsp;is&nbsp;degrees&nbsp;(360&nbsp;maximum)<br>
&nbsp;<br>
Raises:<br>
&nbsp;&nbsp;&nbsp;&nbsp;ValueError:&nbsp;If&nbsp;required&nbsp;parameters&nbsp;are&nbsp;missing&nbsp;or&nbsp;in&nbsp;the&nbsp;wrong&nbsp;format.</span></dd></dl>

<hr>
Methods inherited from <a href="gstatsMCMC.MCMC.html#chain">chain</a>:<br>
<dl><dt><a name="chain_sgs-__init__"><strong>__init__</strong></a>(self, xx, yy, bed, surf, velx, vely, dhdt, smb, cond_bed, data_mask, grounded_ice_mask, resolution)</dt><dd><span class="code">Initialize&nbsp;the&nbsp;Markov&nbsp;<a href="#chain">chain</a>&nbsp;<a href="builtins.html#object">object</a>&nbsp;for&nbsp;topography&nbsp;sampling.<br>
The&nbsp;function&nbsp;has&nbsp;no&nbsp;returns&nbsp;but&nbsp;the&nbsp;input&nbsp;argument&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;<a href="#chain">chain</a>&nbsp;<a href="builtins.html#object">object</a><br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;xx,&nbsp;yy&nbsp;(2D&nbsp;array):&nbsp;x&nbsp;and&nbsp;y&nbsp;coordinates&nbsp;of&nbsp;the&nbsp;map&nbsp;grid.<br>
&nbsp;&nbsp;&nbsp;&nbsp;bed&nbsp;(2D&nbsp;array):&nbsp;Initial&nbsp;bed&nbsp;topography.<br>
&nbsp;&nbsp;&nbsp;&nbsp;surf&nbsp;(2D&nbsp;array):&nbsp;Ice&nbsp;surface&nbsp;elevation.<br>
&nbsp;&nbsp;&nbsp;&nbsp;velx,&nbsp;vely&nbsp;(2D&nbsp;array):&nbsp;Ice&nbsp;surface&nbsp;velocity&nbsp;in&nbsp;x&nbsp;direction&nbsp;and&nbsp;in&nbsp;y&nbsp;direction.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dhdt&nbsp;(2D&nbsp;array):&nbsp;Surface&nbsp;height&nbsp;change&nbsp;rate&nbsp;(annual&nbsp;average).<br>
&nbsp;&nbsp;&nbsp;&nbsp;smb&nbsp;(2D&nbsp;array):&nbsp;Surface&nbsp;mass&nbsp;balance&nbsp;(annual&nbsp;average).<br>
&nbsp;&nbsp;&nbsp;&nbsp;cond_bed&nbsp;(2D&nbsp;array):&nbsp;Conditioning&nbsp;radar&nbsp;bed&nbsp;measurements&nbsp;in&nbsp;the&nbsp;shape&nbsp;of&nbsp;the&nbsp;2D&nbsp;domain.&nbsp;For&nbsp;locations&nbsp;without&nbsp;measurement,&nbsp;the&nbsp;value&nbsp;is&nbsp;nan<br>
&nbsp;&nbsp;&nbsp;&nbsp;data_mask&nbsp;(2D&nbsp;array):&nbsp;Mask&nbsp;of&nbsp;where&nbsp;conditioning&nbsp;data&nbsp;exists&nbsp;(1&nbsp;=&nbsp;exist).<br>
&nbsp;&nbsp;&nbsp;&nbsp;grounded_ice_mask&nbsp;(2D&nbsp;array):&nbsp;Binary&nbsp;mask&nbsp;of&nbsp;grounded&nbsp;ice&nbsp;(1&nbsp;=&nbsp;grounded).<br>
&nbsp;&nbsp;&nbsp;&nbsp;resolution&nbsp;(float):&nbsp;Spatial&nbsp;resolution&nbsp;in&nbsp;meters.<br>
&nbsp;<br>
Raises:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Exception:&nbsp;If&nbsp;input&nbsp;arrays&nbsp;do&nbsp;not&nbsp;have&nbsp;matching&nbsp;shapes.</span></dd></dl>

<dl><dt><a name="chain_sgs-loss"><strong>loss</strong></a>(self, massConvResidual, dataDiff)</dt><dd><span class="code">Compute&nbsp;total&nbsp;loss&nbsp;from&nbsp;mass&nbsp;conservation&nbsp;residuals&nbsp;and&nbsp;data&nbsp;misfit&nbsp;by&nbsp;applying&nbsp;function&nbsp;defined&nbsp;in&nbsp;set_loss_type<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;massConvResidual&nbsp;(2D&nbsp;array):&nbsp;Mass&nbsp;conservation&nbsp;residual&nbsp;field.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dataDiff&nbsp;(2D&nbsp;array):&nbsp;Difference&nbsp;between&nbsp;candidate&nbsp;and&nbsp;observed&nbsp;bed&nbsp;elevation.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;total_loss&nbsp;(float):&nbsp;Combined&nbsp;loss&nbsp;value.<br>
&nbsp;&nbsp;&nbsp;&nbsp;loss_mc&nbsp;(float):&nbsp;Loss&nbsp;due&nbsp;to&nbsp;mass&nbsp;conservation&nbsp;residual.<br>
&nbsp;&nbsp;&nbsp;&nbsp;loss_data&nbsp;(float):&nbsp;Loss&nbsp;due&nbsp;to&nbsp;data&nbsp;misfit.</span></dd></dl>

<dl><dt><a name="chain_sgs-set_high_vel_region"><strong>set_high_vel_region</strong></a>(self, update_in_region, region_mask=[])</dt><dd><span class="code">Define&nbsp;spatial&nbsp;region&nbsp;where&nbsp;ice&nbsp;surface&nbsp;velocity&nbsp;is&nbsp;high&nbsp;to&nbsp;constrain&nbsp;the&nbsp;location&nbsp;of&nbsp;updates.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;update_in_region&nbsp;(bool):&nbsp;Whether&nbsp;to&nbsp;constrain&nbsp;updates&nbsp;to&nbsp;region_mask.<br>
&nbsp;&nbsp;&nbsp;&nbsp;region_mask&nbsp;(2D&nbsp;array):&nbsp;Binary&nbsp;mask&nbsp;specifying&nbsp;region&nbsp;of&nbsp;interest.<br>
&nbsp;<br>
Raises:<br>
&nbsp;&nbsp;&nbsp;&nbsp;ValueError:&nbsp;If&nbsp;region_mask&nbsp;has&nbsp;incorrect&nbsp;shape.</span></dd></dl>

<dl><dt><a name="chain_sgs-set_loss_type"><strong>set_loss_type</strong></a>(self, map_func=None, diff_func=None, sigma_mc=-1, sigma_data=-1, massConvInRegion=True, dataDiffInRegion=False)</dt><dd><span class="code">Configure&nbsp;loss&nbsp;function&nbsp;used&nbsp;in&nbsp;MCMC&nbsp;<a href="#chain">chain</a><br>
Currently&nbsp;enable&nbsp;two&nbsp;losses&nbsp;to&nbsp;be&nbsp;used:&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;and&nbsp;misfit&nbsp;to&nbsp;radar&nbsp;measurements.<br>
The&nbsp;function&nbsp;has&nbsp;no&nbsp;return.&nbsp;Its&nbsp;effect&nbsp;can&nbsp;be&nbsp;checked&nbsp;in&nbsp;<a href="#chain">chain</a>&nbsp;<a href="builtins.html#object">object</a>'s&nbsp;'loss_function_list'&nbsp;attribute<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;map_func&nbsp;(str):&nbsp;Function&nbsp;to&nbsp;use&nbsp;for&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;('meanabs',&nbsp;'meansquare',&nbsp;'sumabs',&nbsp;'sumsquare',&nbsp;None).&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Default&nbsp;is&nbsp;None.&nbsp;If&nbsp;set&nbsp;to&nbsp;None,&nbsp;then&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;is&nbsp;not&nbsp;used&nbsp;for&nbsp;calculating&nbsp;the&nbsp;loss.<br>
&nbsp;&nbsp;&nbsp;&nbsp;'sumsquare'&nbsp;correspond&nbsp;to&nbsp;treat&nbsp;the&nbsp;residual&nbsp;as&nbsp;Gaussian&nbsp;distribution<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;diff_func&nbsp;(str):&nbsp;Function&nbsp;to&nbsp;use&nbsp;for&nbsp;misfit&nbsp;to&nbsp;radar&nbsp;measurements&nbsp;('meanabs',&nbsp;'meansquare',&nbsp;'sumabs',&nbsp;'sumsquare',&nbsp;None).&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Default&nbsp;is&nbsp;None.&nbsp;If&nbsp;set&nbsp;to&nbsp;None,&nbsp;then&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;is&nbsp;not&nbsp;used&nbsp;for&nbsp;calculating&nbsp;the&nbsp;loss.<br>
&nbsp;&nbsp;&nbsp;&nbsp;'sumsquare'&nbsp;correspond&nbsp;to&nbsp;treat&nbsp;the&nbsp;misfit&nbsp;as&nbsp;Gaussian&nbsp;distribution<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;sigma_mc&nbsp;(float):&nbsp;Standard&nbsp;deviation&nbsp;for&nbsp;mass&nbsp;conservation&nbsp;residual.<br>
&nbsp;&nbsp;&nbsp;&nbsp;sigma_data&nbsp;(float):&nbsp;Standard&nbsp;deviation&nbsp;for&nbsp;data&nbsp;misfit.<br>
&nbsp;&nbsp;&nbsp;&nbsp;massConvInRegion&nbsp;(bool):&nbsp;Whether&nbsp;to&nbsp;calculate&nbsp;mass&nbsp;conservation&nbsp;residual&nbsp;only&nbsp;in&nbsp;region_mask.<br>
&nbsp;&nbsp;&nbsp;&nbsp;dataDiffInRegion&nbsp;(bool):&nbsp;Whether&nbsp;to&nbsp;calculate&nbsp;data&nbsp;misfit&nbsp;loss&nbsp;only&nbsp;in&nbsp;region_mask.<br>
&nbsp;<br>
Raises:<br>
&nbsp;&nbsp;&nbsp;&nbsp;ValueError:&nbsp;If&nbsp;function&nbsp;names&nbsp;are&nbsp;invalid&nbsp;or&nbsp;sigmas&nbsp;are&nbsp;missing.</span></dd></dl>

<hr>
Data descriptors inherited from <a href="gstatsMCMC.MCMC.html#chain">chain</a>:<br>
<dl><dt><strong>__dict__</strong></dt>
<dd><span class="code">dictionary&nbsp;for&nbsp;instance&nbsp;variables</span></dd>
</dl>
<dl><dt><strong>__weakref__</strong></dt>
<dd><span class="code">list&nbsp;of&nbsp;weak&nbsp;references&nbsp;to&nbsp;the&nbsp;object</span></dd>
</dl>
</td></tr></table></td></tr></table><p>
<table class="section">
<tr class="decor functions-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Functions</strong></td></tr>
    
<tr><td class="decor functions-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl><dt><a name="-fit_variogram"><strong>fit_variogram</strong></a>(data, coords, roughness_region_mask, maxlag, n_lags=50, samples=0.6, subsample=100000, data_for_trans=[])</dt><dd><span class="code">Fit&nbsp;and&nbsp;compare&nbsp;different&nbsp;variogram&nbsp;models&nbsp;to&nbsp;the&nbsp;given&nbsp;data.<br>
Notice&nbsp;here&nbsp;by&nbsp;default&nbsp;nugget&nbsp;=&nbsp;0.&nbsp;If&nbsp;want&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;case&nbsp;of&nbsp;nugget&nbsp;!=&nbsp;0,&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;the&nbsp;function.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(2D&nbsp;numpy&nbsp;array):&nbsp;A&nbsp;column&nbsp;of&nbsp;input&nbsp;data&nbsp;to&nbsp;compute&nbsp;the&nbsp;variogram&nbsp;on.&nbsp;(use&nbsp;.reshape((-1,1))&nbsp;when&nbsp;the&nbsp;input&nbsp;data&nbsp;is&nbsp;not&nbsp;a&nbsp;column&nbsp;array)<br>
&nbsp;&nbsp;&nbsp;&nbsp;coords&nbsp;(2D&nbsp;numpy&nbsp;array):&nbsp;Coordinates&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;data,&nbsp;where&nbsp;each&nbsp;row&nbsp;representing&nbsp;a&nbsp;location&nbsp;in&nbsp;space,&nbsp;and&nbsp;first&nbsp;column&nbsp;is&nbsp;for&nbsp;x&nbsp;coordinate&nbsp;and&nbsp;second&nbsp;column&nbsp;for&nbsp;y&nbsp;coordinate<br>
&nbsp;&nbsp;&nbsp;&nbsp;roughness_region_mask&nbsp;(2D&nbsp;array):&nbsp;Mask&nbsp;indicating&nbsp;region&nbsp;where&nbsp;roughness&nbsp;is&nbsp;evaluated&nbsp;(1&nbsp;=&nbsp;included).<br>
&nbsp;&nbsp;&nbsp;&nbsp;maxlag&nbsp;(float):&nbsp;Maximum&nbsp;lag&nbsp;distance&nbsp;to&nbsp;consider&nbsp;in&nbsp;variogram.<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_lags&nbsp;(int):&nbsp;Number&nbsp;of&nbsp;lags&nbsp;to&nbsp;compute&nbsp;the&nbsp;variogram.&nbsp;Default&nbsp;is&nbsp;50.<br>
&nbsp;&nbsp;&nbsp;&nbsp;samples&nbsp;(float):&nbsp;Proportion&nbsp;of&nbsp;pairs&nbsp;of&nbsp;points&nbsp;used&nbsp;to&nbsp;compute&nbsp;the&nbsp;experimental&nbsp;variogram.&nbsp;Default&nbsp;is&nbsp;0.6.<br>
&nbsp;&nbsp;&nbsp;&nbsp;subsample&nbsp;(int):&nbsp;Number&nbsp;of&nbsp;samples&nbsp;for&nbsp;quantile&nbsp;transformation.&nbsp;Default&nbsp;is&nbsp;100000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;data_for_trans&nbsp;(list):&nbsp;Optional,&nbsp;only&nbsp;used&nbsp;when&nbsp;the&nbsp;data&nbsp;used&nbsp;to&nbsp;compute&nbsp;the&nbsp;quantile&nbsp;transformation&nbsp;is&nbsp;different&nbsp;from&nbsp;the&nbsp;data&nbsp;transformed.&nbsp;This&nbsp;should&nbsp;be&nbsp;a&nbsp;column&nbsp;array&nbsp;containing&nbsp;data&nbsp;used&nbsp;to&nbsp;calculate&nbsp;quantile&nbsp;transformation<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;nst_trans:&nbsp;QuantileTransformer&nbsp;<a href="builtins.html#object">object</a>&nbsp;used&nbsp;to&nbsp;normalize&nbsp;the&nbsp;data.<br>
&nbsp;&nbsp;&nbsp;&nbsp;transformed_data:&nbsp;Transformed&nbsp;data&nbsp;used&nbsp;in&nbsp;variogram&nbsp;calculation.<br>
&nbsp;&nbsp;&nbsp;&nbsp;params&nbsp;(list):&nbsp;List&nbsp;of&nbsp;parameters&nbsp;for&nbsp;Gaussian,&nbsp;Exponential,&nbsp;Spherical,&nbsp;and&nbsp;Matern&nbsp;variogram&nbsp;models,&nbsp;containing&nbsp;range,&nbsp;sill,&nbsp;and&nbsp;nugget<br>
&nbsp;&nbsp;&nbsp;&nbsp;fig:&nbsp;A&nbsp;matplotlib&nbsp;figure&nbsp;comparing&nbsp;experimental&nbsp;and&nbsp;modeled&nbsp;variograms.</span></dd></dl>
</td></tr></table>
</body></html>